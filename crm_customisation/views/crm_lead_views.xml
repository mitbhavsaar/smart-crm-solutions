<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_crm_lead_form_inherit_custom_seq" model="ir.ui.view">
        <field name="name">crm.lead.form.inherit.custom</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="before">
                <div>
                    <h1>
                        <field name="opportunity_sequence" readonly="1" invisible="type != 'opportunity'"/>
                    </h1>
                </div>
            </xpath>
            <xpath expr="//sheet/notebook" position="inside">
               <page string="Products" name = "product">
                  <field name="material_line_ids" create="false">
                    <list editable ="bottom">
                        <field name="lead_id" column_invisible="1"/>
                        <field name="product_template_id" widget ="crm_product_many2one"/>
                        <field name="product_id" column_invisible="1"/>
                        <field name="description" />
                        <field name="attached_file_name" invisible="1" column_invisible="1"/>
                        <field name="attached_file_id" 
                            widget="binary" 
                            filename="attached_file_name"
                            string="ðŸ“Ž File"
                            optional="show"/>
                        <field name="product_category_id"/>
                        <field name="quantity"/>
                        <field name="product_uom_id"/>
                        <field name="width" column_invisible="1"/>
                        <field name="thickness" column_invisible="1"/>

                        <field name="height" column_invisible="1"/>
                        <field name="length" column_invisible="1"/>
                        <field name="price" widget="monetary" options="{'currency_field': 'currency_id'}" column_invisible="1"/>
                        <field name="price_custom" widget="monetary" options="{'currency_field': 'currency_id'}" readonly="1"/>
                        <field name="discount" string="Disc.%" groups="crm_customisation.group_crm_discount" optional="show"/>
                        <field name="tax_id" widget="many2many_tags" options="{'no_create': True}" optional="show"/>
                        <field name="price_subtotal" widget="monetary" options="{'currency_field': 'currency_id'}" string="Subtotal" optional="show"/>
                        <field name="total_price" widget="monetary"  options="{'currency_field': 'currency_id'}" decoration-bf="1" sum="total_price"/>
                        <field name="currency_id" column_invisible="1"/>
                        
                    </list>
                </field>
                </page>
            </xpath>
            <xpath expr="//field[@name='name']" position="replace">
                <field name="partner_id" string="Contact" context="{'crm_lead_main_contact_only': True, 'res_partner_search_mode':'customer'}" placeholder="Company Name"/>
            </xpath>    
            <xpath expr="//group[@name='opportunity_partner']/field[@name='partner_id']"  position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//div[field[@name='expected_revenue']]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//div[field[@name='probability']]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//div[field[@name='date_deadline']]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//page[@name='lead']//field[@name='campaign_id']/.." position="attributes">
                     <attribute name="invisible">1</attribute>
            </xpath>

           <xpath expr="//group[@name='Misc']" position="attributes">
                <attribute name="invisible">1</attribute>
           </xpath>

            <xpath expr="//sheet/notebook" position="inside">
                <page string="Additional Contacts" name="company_contacts_tab">
                    <field name="company_contact_ids"/>
                </page>
            </xpath>
            
            <!-- Control visibility of New Quotation button based on all_lines_priced -->
            <xpath expr="//button[@name='action_sale_quotations_new']" position="attributes">
                <attribute name="invisible">not all_lines_priced</attribute>
            </xpath>
        </field>
    </record>

    <record id="crm_lead_kanban_view_inherit" model="ir.ui.view">
        <field name="name">crm.lead.kanban.view.inherit.custom</field>
        <field name="model">crm.lead</field>
        <field name="priority" eval="12"/>
        <field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name ='name']" position="replace">
                <div class="o_kanban_record_title">
                    <field name="partner_id" string="Contact" context="{'crm_lead_main_contact_only': True, 'res_partner_search_mode':'customer'}"/>   
                </div>
            </xpath>
            <xpath expr="//templates//t[@t-name='card']//field[@name='partner_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>
    <record id="view_crm_lead_tree_inherit_custom_seq" model="ir.ui.view">
        <field name="name">crm.lead.tree.inherit.custom.seq</field>
        <field name="model">crm.lead</field>
        <field name="priority" eval="0"/>
        <field name="inherit_id" ref="crm.crm_case_tree_view_oppor"/>
        <field name="arch" type="xml">
            <xpath expr="//list" position="inside">
                <field name="opportunity_sequence"/>
            </xpath>
            <xpath expr="//field[@name='name']" position="replace"> 
                <field name="partner_id" string="Contact" context="{'crm_lead_main_contact_only': True, 'res_partner_search_mode':'customer'}"/>
            </xpath>
            <xpath expr="//field[@name='contact_name']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>  
        </field>
    </record>

    <record model="ir.actions.act_window" id="crm.crm_lead_action_pipeline">
        <field name="name">Pipeline</field>
        <field name="res_model">crm.lead</field>
        <field name="view_mode">list,kanban,graph,pivot,form,calendar,activity</field>
        <field name="domain">[('type','=','opportunity')]</field>
        <field name="context">{
                'default_type': 'opportunity',
                'search_default_assigned_to_me': 1
        }</field>
        <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
    </record>

    <record id="crm.crm_lead_action_pipeline_view_kanban" model="ir.actions.act_window.view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">kanban</field>
            <field name="view_id" ref="crm.crm_case_kanban_view_leads"/>
            <field name="act_window_id" ref="crm.crm_lead_action_pipeline"/>
    </record>

    <record id="crm.crm_lead_action_pipeline_view_tree" model="ir.actions.act_window.view">
        <field name="sequence" eval="0"/>
        <field name="view_mode">list</field>
        <field name="view_id" ref="crm.crm_case_tree_view_oppor"/>
        <field name="act_window_id" ref="crm.crm_lead_action_pipeline"/>
    </record>

</odoo>
